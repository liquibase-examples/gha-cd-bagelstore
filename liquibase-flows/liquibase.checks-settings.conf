## Policy Checks Settings File
## All 12 checks configured with BLOCKER severity (exit code 4)
## Based on postgres-flow-policy-demo pattern

fileCreated: 2025-10-05T00:00:00.000Z
fileModified: 2025-10-05T00:00:00.000Z
version: '1.0'

rules:
- description: Warn when 'DROP COLUMN' is detected
  enabled: true
  id: 'ChangeDropColumnWarn'
  name: Warn when 'DROP COLUMN' detected
  severity: '4'
  shortName: ChangeDropColumnWarn

- description: Warn when 'DROP TABLE' is detected
  enabled: true
  id: 'ChangeDropTableWarn'
  name: Warn when 'DROP TABLE' detected
  severity: '4'
  shortName: ChangeDropTableWarn

- description: Warn when 'TRUNCATE TABLE' is detected
  enabled: true
  id: 'ChangeTruncateTableWarn'
  name: Warn when 'TRUNCATE TABLE' detected
  severity: '4'
  shortName: ChangeTruncateTableWarn

- description: Warn on data type modifications
  enabled: true
  id: 'ModifyDataTypeWarn'
  name: Warn when 'MODIFY <column>' detected
  severity: '4'
  shortName: ModifyDataTypeWarn

- description: Require rollback for all changesets
  enabled: true
  id: 'RollbackRequired'
  name: Rollback Required for Changeset
  severity: '4'
  shortName: RollbackRequired

- description: Warn on GRANT with ADMIN OPTION
  enabled: true
  id: 'SqlGrantAdminWarn'
  name: Warn on Detection of 'GRANT WITH ADMIN OPTION'
  severity: '4'
  shortName: SqlGrantAdminWarn

- description: Warn on GRANT with GRANT OPTION
  enabled: true
  id: 'SqlGrantOptionWarn'
  name: Warn on Detection of 'GRANT WITH GRANT OPTION'
  severity: '4'
  shortName: SqlGrantOptionWarn

- description: Warn on GRANT statements
  enabled: true
  id: 'SqlGrantWarn'
  name: Warn when 'GRANT' statements detected
  severity: '4'
  shortName: SqlGrantWarn

- description: Warn on REVOKE statements
  enabled: true
  id: 'SqlRevokeWarn'
  name: Warn when 'REVOKE' statements detected
  severity: '4'
  shortName: SqlRevokeWarn

- description: Ensure tables have appropriate indexes
  enabled: true
  id: 'CheckTablesForIndex'
  name: Check for Index on Table
  severity: '4'
  shortName: CheckTablesForIndex

- description: Warn on SELECT * statements
  enabled: true
  id: 'SqlSelectStarWarn'
  name: Warn on Detection of 'SELECT *'
  severity: '4'
  shortName: SqlSelectStarWarn

- description: Enforce maximum column count per table (50 columns)
  enabled: true
  id: 'TableColumnLimit'
  name: Table Column Limit
  parameters:
  - parameter: MAX_COLUMNS
    value: 50
  severity: '4'
  shortName: TableColumnLimit
